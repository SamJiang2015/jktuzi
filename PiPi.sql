BEGIN TRANSACTION;
CREATE TABLE `workoutTypes` (`id` INTEGER PRIMARY KEY, `description` VARCHAR(255) NOT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
CREATE TABLE `workoutItems` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `date` VARCHAR(255) NOT NULL, `description` VARCHAR(255), `duration` INTEGER, `distance` INTEGER, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, `accountId` INTEGER REFERENCES `accounts` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `workoutTypeId` INTEGER NOT NULL REFERENCES `workoutTypes` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE);
CREATE TABLE `trainees` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `isMale` TINYINT(1) NOT NULL, `nickname` VARCHAR(255) NOT NULL, `email` VARCHAR(255) NOT NULL, `birthdate` DATETIME NOT NULL, `height` INTEGER NOT NULL, `weight` FLOAT NOT NULL, `bodyfat` FLOAT, `profession` VARCHAR(255), `habbit` VARCHAR(255), `location` VARCHAR(255) NOT NULL, `weightGoal` FLOAT, `bodyfatGoal` FLOAT, `signature` VARCHAR(255), `sponsorName` VARCHAR(255) NOT NULL, `sponsorMobile` VARCHAR(255) NOT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, `accountId` INTEGER REFERENCES `accounts` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `sponsorAccountId` INTEGER REFERENCES `accounts` (`id`) ON DELETE SET NULL ON UPDATE CASCADE);
CREATE TABLE `tokens` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `tokenHash` VARCHAR(255), `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
CREATE TABLE `roleTypes` (`id` INTEGER PRIMARY KEY, `description` VARCHAR(255) NOT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
CREATE TABLE `mealTypes` (`id` INTEGER PRIMARY KEY, `description` VARCHAR(255) NOT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
CREATE TABLE `mealItems` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `date` VARCHAR(255) NOT NULL, `recorded` TINYINT(1) NOT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, `accountId` INTEGER REFERENCES `accounts` (`id`) ON DELETE SET NULL ON UPDATE CASCADE, `mealTypeId` INTEGER NOT NULL REFERENCES `mealTypes` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE);
CREATE TABLE `healthItems` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `date` VARCHAR(255) NOT NULL, `weight` FLOAT NOT NULL, `bodyfat` FLOAT, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, `accountId` INTEGER REFERENCES `accounts` (`id`) ON DELETE SET NULL ON UPDATE CASCADE);
CREATE TABLE `groups` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `name` VARCHAR(255) NOT NULL UNIQUE, `nickname` VARCHAR(255), `startdate` VARCHAR(255) NOT NULL, `enddate` VARCHAR(255) NOT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, `groupTypeId` INTEGER NOT NULL REFERENCES `groupTypes` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE);
CREATE TABLE `groupTypes` (`id` INTEGER PRIMARY KEY, `description` VARCHAR(255) NOT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
CREATE TABLE `groupMembers` (`groupId` INTEGER NOT NULL NOT NULL REFERENCES `groups` (`id`) ON DELETE CASCADE ON UPDATE CASCADE, `accountId` INTEGER NOT NULL NOT NULL REFERENCES `accounts` (`id`) ON DELETE CASCADE ON UPDATE CASCADE, `paymentAmount` INTEGER DEFAULT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, `memberTypeId` INTEGER NOT NULL REFERENCES `groupMemberTypes` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE, UNIQUE (groupId, accountId), PRIMARY KEY (`groupId`, `accountId`));
CREATE TABLE `groupMemberTypes` (`id` INTEGER PRIMARY KEY, `description` VARCHAR(255) NOT NULL, `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL);
CREATE TABLE `accounts` (`id` INTEGER PRIMARY KEY AUTOINCREMENT, `mobile` VARCHAR(255) NOT NULL UNIQUE, `name` VARCHAR(255) NOT NULL, `infoCompleted` TINYINT(1) NOT NULL DEFAULT 0, `salt` VARCHAR(255), `password_hash` VARCHAR(255), `createdAt` DATETIME NOT NULL, `updatedAt` DATETIME NOT NULL, `roleTypeId` INTEGER NOT NULL DEFAULT 3 REFERENCES `roleTypes` (`id`) ON DELETE NO ACTION ON UPDATE CASCADE);
COMMIT;
